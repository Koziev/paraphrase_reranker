# Модель определения и ранжирования перефразировок

Пакет содержит предобученную модель, которая может выполнять 2 задачи:

1) определить, являются ли два предложения перефразировкой друг друга;

2) отсортировать варианты перефразировок предложения так, чтобы в начале списка оказались более достоверные перефразировки.

Вторая функция позволяет использовать модель как постобработчик-"улучшитель" для генеративных моделей перефразирования, например [russian-paraphrasers](https://github.com/RussianNLP/russian_paraphrasers).

Особая ценность модели заключается в том, что она обучается на ***независимом*** корпусе перефразировок, который не входит в обучающий корпус для вышеуказанных генеративных моделей.


## Использование

Внимание: при первом запуске будет загружаться модель [ruBert-base](https://huggingface.co/sberbank-ai/ruBert-base), что потребует
пары минут при быстром интернете.


Определение перефразировок:

```
from paraphrase_reranker import ParaphraseRanker

ranker = ParaphraseRanker(device='cpu')
ranker.load()

y = ranker.check_pair('кошка ловит мышку', 'кошка хотится на мышку')
print(y)
```

Этот код выдаст:

```
кошка ловит мышку <==> кошка охотится на мышку ==> 0.9999984502792358
меня зовут илья <==> мое имя илья ==> 0.9999750852584839
```


Сортировка вариантов перефразировки:

```
from paraphrase_reranker import ParaphraseRanker

ranker = ParaphraseRanker(device='cpu')
ranker.load()

px2 = ranker.rerank('кошка ловит мышку', ['кошка охотится на мышку', 'мыши едят зерно', 'у кошки зеленые глаза'])
print(px2)
```

Результат работы кода:

```
[('кошка охотится на мышку', 0.99999845), ('мыши едят зерно', 4.252427e-09), ('у кошки зеленые глаза', 1.8255392e-11)]
```



